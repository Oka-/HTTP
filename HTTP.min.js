// Colin 'Oka' Hall-Coates <yo@oka.io>
// MIT 2015
window.HTTP=!window.hasOwnProperty("HTTP")&&function(){function e(e){r[e]=function(t){return r(e,t)}}function t(e,t){e.timer&&window.clearTimeout(e.timer),t&&t.call(),e.request.readyState<2&&(e.timer=window.setTimeout(function(){e.request.send(e.data)},u.delay))}function n(e){return"string"==typeof e?e:Object.keys(e).map(function(t){return t+"="+e[t]}).join("&")}function r(e,r){var i={callbacks:[],data:null,timer:null,request:new XMLHttpRequest},o={cred:function(){return t(i,function(){i.request.withCredentials=!0}),this},"do":function(e){return t(i,function(){e.call(i.request,i.request.response,i.request.status,i.request)}),this},data:function(e){return t(i,function(){i.data=n(e)}),this},mime:function(e){return t(i,function(){i.request.overrideMimeType(e)}),this},set:function(e,n){return t(i,function(){i.request.setRequestHeader(e,n)}),this},then:function(e){return t(i,function(){i.callbacks.push(e)}),this}};return u.methods.indexOf(e.toUpperCase())<0&&(r=e,e="GET"),i.request.addEventListener("load",function(){i.callbacks.forEach(function(e){o["do"](e)})}),i.request.open(e,r,!0),t(i),o}var u={methods:["GET","POST","PUT","DELETE","HEAD","OPTIONS"],delay:50};return r.delay=function(e){return u.delay=e||u.delay,u.delay},u.methods.forEach(e),r}();